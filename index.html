<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flipperz – Brought to you by NUMBERED</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Manrope', sans-serif;
      background: #0a0a0a;
      color: white;
      margin: 0;
      padding: 0 16px;
    }
    .container {
      max-width: 720px;
      margin: auto;
      padding: 32px 0;
      text-align: center;
    }
    #searchInput {
      width: 90%;
      max-width: 480px;
      background: #1a1a1a;
      color: white;
      font-size: 1em;
      border: none;
      border-radius: 32px;
      padding: 14px 20px;
      margin-bottom: 16px;
    }
    button {
      background: #00cc6a;
      color: black;
      font-weight: bold;
      border: none;
      padding: 12px 24px;
      border-radius: 24px;
      cursor: pointer;
      margin-top: 8px;
    }
    .result-item {
      display: flex;
      align-items: center;
      background: #111;
      padding: 12px;
      border-radius: 12px;
      margin: 12px 0;
      gap: 16px;
    }
    .result-item img {
      width: 80px;
      height: auto;
      border-radius: 6px;
      cursor: pointer;
    }
    .result-text {
      text-align: left;
    }
    #slider {
      width: 300px;
      margin-top: 20px;
    }
    .output {
      margin-top: 10px;
      font-size: 1em;
      font-weight: 600;
    }
  </style>
</head>
<body>
<div class="container">
  <img src="flipperz-logo.png" alt="Flipperz Logo" style="width: 240px; height: auto; margin-bottom: 16px;" />
  <input id="searchInput" type="text" placeholder="Search any card, set, or product" />
  <br />
  <button onclick="runSearch()">Search eBay Sold Listings</button>

  <div style="margin-top:24px;">Adjust Offer %: <span id="sliderDisplay">80%</span></div>
  <input type="range" id="slider" min="60" max="100" step="5" value="80" oninput="updateOfferCalc()">

  <div class="output" id="offerOutput">Select comps to calculate average.</div>

  <div id="results"></div>
</div>

<script>
const PRODUCTION_OAUTH_TOKEN = 'v^1.1#i^1#I^3#p^3#r^0#f^0#t^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';

async function runSearch() {
  const query = document.getElementById('searchInput').value.trim();
  const results = document.getElementById('results');
  results.innerHTML = '';

  if (!query) {
    results.innerHTML = '<p style="color:#888;">Please enter a search term.</p>';
    return;
  }

  try {
    const response = await fetch(`https://api.ebay.com/buy/browse/v1/item_summary/search?q=${encodeURIComponent(query)}&filter=buyingOptions:{FIXED_PRICE}&limit=20`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${PRODUCTION_OAUTH_TOKEN}`,
        'Content-Type': 'application/json',
        'X-EBAY-C-MARKETPLACE-ID': 'EBAY_US'
      }
    });

    if (!response.ok) throw new Error('Fetch error: ' + response.status);

    const data = await response.json();

    if (!data.itemSummaries || data.itemSummaries.length === 0) {
      results.innerHTML = '<p style="color:#888;">No sold listings found. Try a different search.</p>';
      return;
    }

    let html = '';

    data.itemSummaries.forEach(item => {
      const title = item.title || 'No title';
      const img = item.image?.imageUrl || 'https://via.placeholder.com/80';
      const price = item.price?.value ? parseFloat(item.price.value) : 0;

      if (!price) return;

      html += `
        <div class="result-item">
          <input type="checkbox" data-price="${price}" onchange="updateOfferCalc()" />
          <img src="${img}" alt="Card" />
          <div class="result-text">
            <strong>$${price.toFixed(2)}</strong><br />${title}
          </div>
        </div>
      `;
    });

    results.innerHTML = html;
    updateOfferCalc();

  } catch (err) {
    console.error(err);
    results.innerHTML = '<p style="color:#f66;">Error fetching results. Try again later.</p>';
  }
}

function updateOfferCalc() {
  const slider = document.getElementById('slider');
  const val = parseInt(slider.value);
  document.getElementById('sliderDisplay').textContent = `${val}%`;

  const checkboxes = document.querySelectorAll('input[type="checkbox"][data-price]');
  let total = 0, count = 0;

  checkboxes.forEach(cb => {
    if (cb.checked) {
      total += parseFloat(cb.dataset.price);
      count++;
    }
  });

  const offerOutput = document.getElementById('offerOutput');
  if (count === 0) {
    offerOutput.textContent = 'Select comps to calculate average.';
    return;
  }

  const average = total / count;
  const offer = (average * val / 100).toFixed(2);
  offerOutput.textContent = `Average of ${count} comps: $${average.toFixed(2)} → ${val}% Offer: $${offer}`;
}
</script>

</body>
</html>
